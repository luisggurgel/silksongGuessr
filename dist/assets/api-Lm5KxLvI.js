const a="http://localhost:5001/api",r={login:async(t,o)=>{const e=await fetch(`${a}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({loginInput:t,password:o})}),n=await e.json();return e.ok&&(localStorage.setItem("token",n.token),localStorage.setItem("user",JSON.stringify(n.user))),{ok:e.ok,data:n}},register:async(t,o,e)=>{const n=await fetch(`${a}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,email:o,password:e})}),s=await n.json();return n.ok&&(localStorage.setItem("token",s.token),localStorage.setItem("user",JSON.stringify(s.user))),{ok:n.ok,data:s}},googleLogin:async t=>{console.log("Sending Google token to backend...");const o=await fetch(`${a}/auth/google`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t})}),e=await o.json();return console.log("Backend response:",e),o.ok?(console.log("Login successful, saving token:",e.token),localStorage.setItem("token",e.token),localStorage.setItem("user",JSON.stringify(e.user))):console.error("Login failed:",e),{ok:o.ok,data:e}},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user")},isAuthenticated:()=>!!localStorage.getItem("token"),getUser:()=>JSON.parse(localStorage.getItem("user"))},l={saveResult:async t=>{const o=localStorage.getItem("token");if(console.log("[API] Saving result. Token exists?",!!o),!o){console.error("[API] No token found, aborting save.");return}console.log("[API] Sending payload:",t);try{const e=await fetch(`${a}/game/result`,{method:"POST",headers:{"Content-Type":"application/json","x-auth-token":o},body:JSON.stringify(t)}),n=await e.json();return console.log("[API] Save response:",e.status,n),n}catch(e){throw console.error("[API] Save error:",e),e}},getProfile:async()=>{const t=localStorage.getItem("token");return t?await(await fetch(`${a}/user/profile`,{headers:{"x-auth-token":t}})).json():null}};export{r as a,l as g};
